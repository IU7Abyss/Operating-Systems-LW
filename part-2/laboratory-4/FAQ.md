# FAQ

> Какие типы файлов определены в Unix/Linux?

* Обычный файл.

* Директория.

* Файл блочного устройства. Буферизованный ввод-вывод для устройств с фиксированным размером блока.

* Файл символьного устройства. Небуферизованный ввод-вывод для устройств с переменным размером блока.

* FIFO (именованный канал). Для обмена информации между процессами.

* Сокет. Для обмена информации через сетевое соеднинение.

* Soft link. Ссылка на другой файл.

---

> Как создать файл с правами доступа для всех видов пользователей равными 0?

```
touch file && chmod 0 file
```

---

> Как создать файл с полными доступа для всех видов пользователей?

```
touch file && chmod 777 file
```

---

> Что произойдёт, если маску режима создания файлов задать равной `777`?

При создания нового файла, ни один из пользователей не сможет выполнять операции `read`/`write`/`execute` (за исключением `root` ofc).

---

> Сможете ли вы прочитать собственный файл при сброшенном бите `user-read`?

Нет.

---

> Какое поле `struct stat` отвечает за размер файла?

Поле `st_size` содержит размер файла (в байтах).

---

> Чему равно значение размера файла для soft link?

Значению длины пути к файлу. (В примере = 8)

```
$ ln -s /usr/lib lib
$ ls -l lib
lrwxrwxrwx 1 root root 8 Mar 30 17:44 lib -> /usr/lib
```

---

> Что определяет поле `st_blksize` в `struct stat`?

Оптимальный размер блока для операций ввода-вывода.

---

> Что определяет поле `st_blocks` в `struct stat`?

Количество 512-байтных блоков занимаемых файлом.

---

> Какой размер буфера надо установить для минимизации времени выполнения операций ввода-вывода?

Размер буфера должен быть равен `st_blksize`.

---

> Разница между работой команд `ls -l` и `du -s`

- `ls -l` выводит значение `st_size`;
- `du -s` выводит значение `st_blocks`.

> Как уменьшить размер файла?

`truncate -s 10M file`

---

> Что происходит при перемещении/переименовании файла в пределах одной файловой системы с фактическим содержимым файла (с его индексными узлами)? Изменяется ли при этом счётчик ссылок?

Содержимое файла никуда не перемещается, в директорию добавляется новая запись на существующий i-node, старая запись удаляется. Счётчик ссылок не изменяется.

---

> Какая функция удаляет записи из каталога? Когда можно удалить файл и что происходит с его индексными узлами?

Функция `unlink()`. Когда счётчик hard link достигнет значения `0`, а также не один из процессов не использует файл.

---

> Файл имеет три атрибута времени: `st_atime`, `st_mtime`, `st_ctime`. Какой ключ команды `ls` позволит вывести на экран информацию о последнем изменении статуса индексного узла?

* `st_atime` - время последнего доступа к содержимому файла (`read`) (`ls -u`)

* `st_mtime` - время последнего изменения содержимого файла (`write`) (default)

* `st_ctime` - время последнего изменения статуса i-node (`chmod`, `chown`) (`ls -cd`)

---

> Что возвращает функция `opendir()`?

`DIR *`

---

> Какая функция "читает" содержимое каталога?

```
readdir()
```
---

> Когда с помощью команды `rmdir` будет удален из системы каталог?

Когда счётчик ссылок достигнет `0` и при этом ни один из процессов не держит директорию открытым.

---

# Links
http://pubs.opengroup.org/onlinepubs/9699919799/